{"version":3,"sources":["../src/application.js"],"names":["Vue","PluginUseManager","SCOPE","Application","constructor","instance","pluginUseManager","get","Promise","resolve","reject","tryInstance","tried","maxTried","setTimeout","use","pluginUses","Object","keys","forEach","name","pluginsReady","resetAttaching","ready","createDefault","appComponent","appElement","assign","render","h","attached","$mount","createFailed","appFailedComponent","then","failed","catch","create","appPluginUses","default"],"mappings":"AAAA,MAAOA,CAAAA,GAAP,KAAgB,KAAhB,CACA,MAAOC,CAAAA,gBAAP,EAA0BC,KAA1B,KAAsC,cAAtC,CAEA,cAAe,MAAMC,CAAAA,WAAY,CAC7BC,WAAW,EAAG,CACV,KAAKC,QAAL,CAAgB,IAAhB,CACA,KAAKC,gBAAL,CAAwB,GAAIL,CAAAA,gBAC/B,CAEDM,GAAG,EAAG,CACF,MAAO,IAAIC,CAAAA,OAAJ,CAAY,CAACC,OAAD,CAAUC,MAAV,GAAqB,CACpC,KAAMC,CAAAA,WAAW,CAAG,CAACC,KAAK,CAAG,CAAT,CAAYC,QAAQ,CAAG,GAAvB,GAA+B,CAC/C,GAAI,KAAKR,QAAT,CAAmB,CACfI,OAAO,CAAC,KAAKJ,QAAN,CAAP,CACA,MACH,CAED,GAAIO,KAAK,GAAKC,QAAd,CAAwB,CACpBH,MAAM,GACN,MACH,CAEDI,UAAU,CAAC,IAAMH,WAAW,CAAC,EAAEC,KAAH,CAAlB,CAA6B,GAA7B,CACb,CAZD,CAcAD,WAAW,EACd,CAhBM,CAiBV,CAEDI,GAAG,CAACC,UAAU,CAAG,EAAd,CAAkB,CACjBC,MAAM,CAACC,IAAP,CAAYF,UAAZ,EAAwBG,OAAxB,CAAgCC,IAAI,EAAI,KAAKd,gBAAL,CAAsBS,GAAtB,CAA0BK,IAA1B,CAAgCJ,UAAU,CAACI,IAAD,CAA1C,CAAxC,EACA,MAAO,KACV,CAEDC,YAAY,EAAG,CACX,MAAO,MAAKf,gBAAL,CAAsBgB,cAAtB,GAAuCC,KAAvC,EACV,CAEDC,aAAa,CAACC,YAAD,CAAeC,UAAU,CAAG,MAA5B,CAAoC,CAC7C,KAAKrB,QAAL,CAAgB,GAAIL,CAAAA,GAAJ,CAAQiB,MAAM,CAACU,MAAP,CAAc,CAClCC,MAAM,CAAEC,CAAC,EAAIA,CAAC,CAACJ,YAAD,CADoB,CAAd,CAErB,KAAKnB,gBAAL,CAAsBwB,QAFD,CAAR,EAEoBC,MAFpB,CAE2BL,UAF3B,CAGnB,CAEDM,YAAY,CAACC,kBAAD,CAAqBP,UAAU,CAAG,MAAlC,CAA0C,CAClD,KAAKL,YAAL,GACKa,IADL,CACU,IAAM,KAAK5B,gBAAL,CAAsBiB,KAAtB,CAA4BrB,KAAK,CAACiC,MAAlC,EACPD,IADO,CACF,IAAM,KAAKV,aAAL,CAAmBS,kBAAnB,CAAuCP,UAAvC,CADJ,EAEPU,KAFO,CAED,IAAM,KAAKZ,aAAL,CAAmBS,kBAAnB,CAAuCP,UAAvC,CAFL,CADhB,EAIKU,KAJL,CAIW,IAAM,KAAKZ,aAAL,CAAmBS,kBAAnB,CAAuCP,UAAvC,CAJjB,CAKH,CAEDW,MAAM,CAACZ,YAAD,CAAeQ,kBAAf,CAAmCK,aAAa,CAAG,EAAnD,CAAuDZ,UAAU,CAAG,MAApE,CAA4E,CAC9E,KAAKX,GAAL,CAASuB,aAAT,EACKjB,YADL,GAEKa,IAFL,CAEU,IAAM,KAAK5B,gBAAL,CAAsBiB,KAAtB,CAA4BrB,KAAK,CAACqC,OAAlC,EACPL,IADO,CACF,IAAM,KAAKV,aAAL,CAAmBC,YAAnB,CAAiCC,UAAjC,CADJ,EAEPU,KAFO,CAED,IAAM,KAAKJ,YAAL,CAAkBC,kBAAlB,CAAsCP,UAAtC,CAFL,CAFhB,EAKKU,KALL,CAKW,IAAM,KAAKJ,YAAL,CAAkBC,kBAAlB,CAAsCP,UAAtC,CALjB,CAMH,CAxD4B","sourcesContent":["import Vue from 'vue'\r\nimport PluginUseManager, {SCOPE} from './plugin-use'\r\n\r\nexport default class Application {\r\n    constructor() {\r\n        this.instance = null\r\n        this.pluginUseManager = new PluginUseManager()\r\n    }\r\n\r\n    get() {\r\n        return new Promise((resolve, reject) => {\r\n            const tryInstance = (tried = 1, maxTried = 100) => {\r\n                if (this.instance) {\r\n                    resolve(this.instance)\r\n                    return\r\n                }\r\n\r\n                if (tried === maxTried) {\r\n                    reject()\r\n                    return\r\n                }\r\n\r\n                setTimeout(() => tryInstance(++tried), 200)\r\n            }\r\n\r\n            tryInstance()\r\n        })\r\n    }\r\n\r\n    use(pluginUses = {}) {\r\n        Object.keys(pluginUses).forEach(name => this.pluginUseManager.use(name, pluginUses[name]))\r\n        return this\r\n    }\r\n\r\n    pluginsReady() {\r\n        return this.pluginUseManager.resetAttaching().ready()\r\n    }\r\n\r\n    createDefault(appComponent, appElement = '#app') {\r\n        this.instance = new Vue(Object.assign({\r\n            render: h => h(appComponent),\r\n        }, this.pluginUseManager.attached)).$mount(appElement)\r\n    }\r\n\r\n    createFailed(appFailedComponent, appElement = '#app') {\r\n        this.pluginsReady()\r\n            .then(() => this.pluginUseManager.ready(SCOPE.failed)\r\n                .then(() => this.createDefault(appFailedComponent, appElement))\r\n                .catch(() => this.createDefault(appFailedComponent, appElement)))\r\n            .catch(() => this.createDefault(appFailedComponent, appElement))\r\n    }\r\n\r\n    create(appComponent, appFailedComponent, appPluginUses = [], appElement = '#app') {\r\n        this.use(appPluginUses)\r\n            .pluginsReady()\r\n            .then(() => this.pluginUseManager.ready(SCOPE.default)\r\n                .then(() => this.createDefault(appComponent, appElement))\r\n                .catch(() => this.createFailed(appFailedComponent, appElement)))\r\n            .catch(() => this.createFailed(appFailedComponent, appElement))\r\n    }\r\n}\r\n"],"file":"application.js"}
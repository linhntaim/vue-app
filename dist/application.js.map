{"version":3,"sources":["../src/application.js"],"names":["Application","instance","pluginUseManager","PluginUseManager","Promise","resolve","reject","tryInstance","tried","maxTried","setTimeout","pluginUses","Object","keys","forEach","name","use","resetAttaching","ready","appComponent","readyCallback","appElement","failed","Vue","assign","render","h","beforeCreate","attached","$mount","appFailedComponent","pluginsReady","then","SCOPE","createDefault","appPluginUses","createFailed"],"mappings":"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","sourcesContent":["import Vue from 'vue'\r\nimport PluginUseManager, {SCOPE} from './plugin-use'\r\n\r\nexport default class Application {\r\n    constructor() {\r\n        this.instance = null\r\n        this.pluginUseManager = new PluginUseManager()\r\n    }\r\n\r\n    get() {\r\n        return new Promise((resolve, reject) => {\r\n            const tryInstance = (tried = 1, maxTried = 100) => {\r\n                if (this.instance) {\r\n                    resolve(this.instance)\r\n                    return\r\n                }\r\n\r\n                if (tried === maxTried) {\r\n                    reject()\r\n                    return\r\n                }\r\n\r\n                setTimeout(() => tryInstance(++tried), 200)\r\n            }\r\n\r\n            tryInstance()\r\n        })\r\n    }\r\n\r\n    use(pluginUses = {}) {\r\n        Object.keys(pluginUses).forEach(name => this.pluginUseManager.use(name, pluginUses[name]))\r\n        return this\r\n    }\r\n\r\n    pluginsReady() {\r\n        return this.pluginUseManager.resetAttaching().ready()\r\n    }\r\n\r\n    createDefault(appComponent, readyCallback = null, appElement = '#app', failed = false) {\r\n        this.instance = new Vue(Object.assign({\r\n            render: h => h(appComponent),\r\n            beforeCreate() {\r\n                readyCallback && readyCallback(this, failed)\r\n            },\r\n        }, this.pluginUseManager.attached)).$mount(appElement)\r\n    }\r\n\r\n    createFailed(appFailedComponent, readyCallback = null, appElement = '#app') {\r\n        this.pluginsReady()\r\n            .then(() => this.pluginUseManager.ready(SCOPE.failed)\r\n                .then(() => this.createDefault(appFailedComponent, readyCallback, appElement, true))\r\n                .catch(() => this.createDefault(appFailedComponent, readyCallback, appElement, true)))\r\n            .catch(() => this.createDefault(appFailedComponent, readyCallback, appElement, true))\r\n    }\r\n\r\n    create(appComponent, appFailedComponent, appPluginUses = [], readyCallback = null, appElement = '#app') {\r\n        this.use(appPluginUses)\r\n            .pluginsReady()\r\n            .then(() => this.pluginUseManager.ready(SCOPE.default)\r\n                .then(() => this.createDefault(appComponent, readyCallback, appElement))\r\n                .catch(() => this.createFailed(appFailedComponent, readyCallback, appElement)))\r\n            .catch(() => this.createFailed(appFailedComponent, readyCallback, appElement))\r\n    }\r\n}\r\n"],"file":"application.js"}
{"version":3,"sources":["../src/application.js"],"names":["Application","instance","pluginUseManager","PluginUseManager","clientIps","maintenanceMode","limitationMode","Promise","resolve","reject","tryInstance","tried","maxTried","setTimeout","pluginUses","Object","keys","forEach","name","use","handle","register","Vue","mixin","beforeCreate","resetAttaching","ready","appComponent","appElement","failed","assign","render","h","attached","$mount","appFailedComponent","pluginsReady","then","SCOPE","createDefault","createFailed"],"mappings":"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","sourcesContent":["import Vue from 'vue'\r\nimport PluginUseManager, {SCOPE} from './plugin-use'\r\n\r\nexport default class Application {\r\n    constructor() {\r\n        this.instance = null\r\n        this.pluginUseManager = new PluginUseManager()\r\n\r\n        this.clientIps = []\r\n        this.maintenanceMode = null\r\n        this.limitationMode = null\r\n    }\r\n\r\n    maintenance(maintenanceMode) {\r\n        if (typeof maintenanceMode !== 'undefined') {\r\n            this.maintenanceMode = maintenanceMode\r\n        }\r\n        return this.maintenanceMode\r\n    }\r\n\r\n    limitation(limitationMode) {\r\n        if (typeof limitationMode !== 'undefined') {\r\n            this.limitationMode = limitationMode\r\n        }\r\n        return this.limitationMode\r\n    }\r\n\r\n    ips(clientIps) {\r\n        if (typeof clientIps !== 'undefined') {\r\n            this.clientIps = clientIps\r\n        }\r\n        return this.clientIps\r\n    }\r\n\r\n    get() {\r\n        return new Promise((resolve, reject) => {\r\n            const tryInstance = (tried = 1, maxTried = 100) => {\r\n                if (this.instance) {\r\n                    resolve(this.instance)\r\n                    return\r\n                }\r\n\r\n                if (tried === maxTried) {\r\n                    reject()\r\n                    return\r\n                }\r\n\r\n                setTimeout(() => tryInstance(++tried), 200)\r\n            }\r\n\r\n            tryInstance()\r\n        })\r\n    }\r\n\r\n    use(pluginUses = {}) {\r\n        Object.keys(pluginUses).forEach(name => this.pluginUseManager.use(name, pluginUses[name]))\r\n        return this\r\n    }\r\n\r\n    register(handle) {\r\n        let register = false\r\n        Vue.mixin({\r\n            beforeCreate() {\r\n                if (!register) {\r\n                    register = true\r\n                    handle(this)\r\n                }\r\n            },\r\n        })\r\n        return this\r\n    }\r\n\r\n    pluginsReady() {\r\n        return this.pluginUseManager.resetAttaching().ready()\r\n    }\r\n\r\n    createDefault(appComponent, appElement = '#app', failed = false) {\r\n        this.instance = new Vue(Object.assign({\r\n            render: h => h(appComponent),\r\n        }, this.pluginUseManager.attached)).$mount(appElement)\r\n    }\r\n\r\n    createFailed(appFailedComponent, appElement = '#app') {\r\n        this.pluginsReady()\r\n            .then(() => this.pluginUseManager.ready(SCOPE.failed)\r\n                .then(() => this.createDefault(appFailedComponent, appElement, true))\r\n                .catch(() => this.createDefault(appFailedComponent, appElement, true)))\r\n            .catch(() => this.createDefault(appFailedComponent, appElement, true))\r\n    }\r\n\r\n    create(appComponent, appFailedComponent, appElement = '#app') {\r\n        this.pluginsReady()\r\n            .then(() => this.pluginUseManager.ready(SCOPE.default)\r\n                .then(() => this.createDefault(appComponent, appElement))\r\n                .catch(() => this.createFailed(appFailedComponent, appElement)))\r\n            .catch(() => this.createFailed(appFailedComponent, appElement))\r\n    }\r\n}\r\n"],"file":"application.js"}